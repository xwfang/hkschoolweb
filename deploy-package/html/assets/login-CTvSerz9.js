import{t as e}from"./useMutation-DOFzbWlu.js";import{P as t,j as n,l as r,n as i}from"./index-CtGP5V70.js";import"./middleware-B8Tclb96.js";import{t as a}from"./auth-BHH58HuU.js";import{a as o,i as s,n as c,o as l,r as u,t as d}from"./card-CTcLBD8i.js";import{t as f}from"./client-DDqdnC_J.js";import{t as p}from"./button-D9YJsIxB.js";import{t as m}from"./input-CXPlNnrV.js";var h=t();const g={login:async e=>(await f.post(`/auth/login`,{identifier:e})).data,verify:async e=>(await f.post(`/auth/verify`,e)).data};var _=r();function v(){let{t}=i(),[r,f]=(0,h.useState)(``),[v,y]=(0,h.useState)(``),[b,x]=(0,h.useState)(`phone`),[S,C]=(0,h.useState)(``),w=n(),T=a(e=>e.setAuth),E=e=>/^[4-9]\d{7}$/.test(e)?`+852${e}`:e,D=e({mutationFn:g.login,onSuccess:()=>{x(`otp`),C(``)},onError:()=>{C(t(`auth.send_otp_error`))}}),O=e({mutationFn:g.verify,onSuccess:e=>{T(e.token,e.user),localStorage.setItem(`token`,e.token),w(`/app`)},onError:()=>{C(t(`auth.verify_error`))}});return(0,_.jsxs)(d,{className:`shadow-xl border-0`,children:[(0,_.jsxs)(o,{className:`space-y-2`,children:[(0,_.jsx)(l,{className:`text-2xl`,children:t(`auth.login_title`)}),(0,_.jsx)(u,{className:`text-base`,children:t(b===`phone`?`auth.phone_step_desc`:`auth.otp_step_desc`)})]}),(0,_.jsxs)(c,{className:`space-y-4`,children:[S&&(0,_.jsx)(`div`,{className:`p-3 text-sm text-red-600 bg-red-50 rounded-md border border-red-200 animate-fade-in`,children:S}),b===`phone`?(0,_.jsx)(m,{type:`tel`,placeholder:t(`auth.phone_placeholder`),value:r,onChange:e=>f(e.target.value),disabled:D.isPending}):(0,_.jsx)(m,{type:`text`,placeholder:t(`auth.otp_placeholder`),value:v,onChange:e=>y(e.target.value),disabled:O.isPending})]}),(0,_.jsx)(s,{children:b===`phone`?(0,_.jsx)(p,{className:`w-full`,onClick:()=>{if(!r)return;let e=E(r);D.mutate(e)},disabled:!r||D.isPending,children:D.isPending?t(`auth.sending`):t(`auth.send_code`)}):(0,_.jsx)(p,{className:`w-full`,onClick:()=>{if(!v)return;let e=E(r);O.mutate({identifier:e,code:v})},disabled:!v||O.isPending,children:O.isPending?t(`auth.logging_in`):t(`auth.login`)})})]})}export{v as default};